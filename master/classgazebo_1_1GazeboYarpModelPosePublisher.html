<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gazebo-yarp-plugins: gazebo::GazeboYarpModelPosePublisher Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gazebo-yarp-plugins
   </div>
   <div id="projectbrief">Gazebo Plugins exposing YARP interfaces.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classgazebo_1_1GazeboYarpModelPosePublisher.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classgazebo_1_1GazeboYarpModelPosePublisher-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">gazebo::GazeboYarpModelPosePublisher Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Gazebo Plugin that publishes the pose of the root link of a model with respect to the Gazebo world frame.  
 <a href="classgazebo_1_1GazeboYarpModelPosePublisher.html#details">More...</a></p>

<p><code>#include &lt;ModelPosePublisher.hh&gt;</code></p>
<div class="dynheader">
Inheritance diagram for gazebo::GazeboYarpModelPosePublisher:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classgazebo_1_1GazeboYarpModelPosePublisher__inherit__graph.svg" width="235" height="127"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for gazebo::GazeboYarpModelPosePublisher:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classgazebo_1_1GazeboYarpModelPosePublisher__coll__graph.svg" width="235" height="127"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9b90da86ecc24bde8a06f6ab44b3656b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgazebo_1_1GazeboYarpModelPosePublisher.html#a9b90da86ecc24bde8a06f6ab44b3656b">~GazeboYarpModelPosePublisher</a> ()</td></tr>
<tr class="separator:a9b90da86ecc24bde8a06f6ab44b3656b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a443d587f78d61eee674eaabe1256f15e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgazebo_1_1GazeboYarpModelPosePublisher.html#a443d587f78d61eee674eaabe1256f15e">Load</a> (gazebo::physics::ModelPtr, <a class="el" href="namespacesdf.html#aa84b558ad591636c16db64bb4c612b71">sdf::ElementPtr</a>)</td></tr>
<tr class="memdesc:a443d587f78d61eee674eaabe1256f15e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store pointer to the model, load parameters from the SDF, configure the frame transform client, reset the time of the last update and connect to the World update event of Gazebo.  <a href="classgazebo_1_1GazeboYarpModelPosePublisher.html#a443d587f78d61eee674eaabe1256f15e">More...</a><br /></td></tr>
<tr class="separator:a443d587f78d61eee674eaabe1256f15e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Gazebo Plugin that publishes the pose of the root link of a model with respect to the Gazebo world frame. </p>
<p>This plugin instantiates a <code>yarp::dev::FrameTransformClient</code> in order to publish the transform between the Gazebo world frame and the root link of the model. This requires a <code>yarp::dev::FrameTransformServer</code> to be actived and running before the model is inserted in Gazebo. It is not required to write code in order to have a working <code>FrameTransfomServer</code>. Instead <code>yarpdev</code> can be used from the command line, e.g. </p><div class="fragment"><div class="line">yarpdev --device transformServer --ROS::enable_ros_publisher <span class="keyword">false</span> --ROS::enable_ros_subscriber <span class="keyword">false</span></div>
</div><!-- fragment --><p> In the example above support to ROS is disabled.</p>
<p>Each transform published by the plugin contains as <code>source</code> frame the string "/inertial" and as <code>target</code> frame a string that depends on the <code>name</code> option of the <code>model</code> tag within the SDF. If such a name is <code>&lt;name&gt;</code> the string describing the <code>target</code> will be "/&lt;name&gt;/frame". In case the model <code>&lt;name&gt;</code> is inserted in the Gazebo environment more than once than the its name becomes <code>&lt;name&gt;_x</code> where <code>x</code> assumes the values <code>0, 1, 2...</code>. This beavior depends on the internal behavior of Gazebo.</p>
<p>The pose published by the plugin is that of the <b>root link</b> of the model with respect to the Gazebo world frame. If the SDF of the model is the following </p><div class="fragment"><div class="line">&lt;<a class="code" href="namespacesdf.html">sdf</a>&gt;</div>
<div class="line">  &lt;model name=<span class="stringliteral">&quot;object&quot;</span>&gt;</div>
<div class="line">  &lt;!-- pose of model frame w.r.t Gazebo world --&gt;</div>
<div class="line">  &lt;pose&gt; x_m y_m z_m roll_m pich_m yaw_m &lt;/pose&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;link name=<span class="stringliteral">&quot;object_root_link&quot;</span>&gt;</div>
<div class="line">    &lt;!-- pose of the root link w.r.t the model frame --&gt;</div>
<div class="line">    &lt;pose&gt; x_l y_l z_l roll_l pich_l yaw_l &lt;/pose&gt;    </div>
<div class="line">    ...</div>
<div class="line">    &lt;/link&gt;</div>
<div class="line"> </div>
<div class="line">   &lt;plugin name=<span class="stringliteral">&#39;...&#39;</span> filename=<span class="stringliteral">&#39;libgazebo_yarp_modelposepublisher.so&#39;</span>&gt;</div>
<div class="line">     &lt;period&gt;1.0&lt;/period&gt;</div>
<div class="line">   &lt;/plugin&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;/model&gt;</div>
<div class="line">&lt;\sdf&gt;</div>
<div class="ttc" id="anamespacesdf_html"><div class="ttname"><a href="namespacesdf.html">sdf</a></div><div class="ttdef"><b>Definition:</b> ConfHelpers.hh:21</div></div>
</div><!-- fragment --><p> then the pose of the root link depends on both the transformation between the Gazebo world frame and the model frame and the transformation between the model frame and the root link.</p>
<p>In order to retrieve the published transform an istance of <code>yarp::dev::FrameTransformClient</code> can be used. An example is provided below </p><div class="fragment"><div class="line">...</div>
<div class="line"><span class="comment">// Instantiate the driver</span></div>
<div class="line">yarp::dev::PolyDriver m_drvTransformClient;</div>
<div class="line">yarp::dev::IFrameTransform* m_tfClient;</div>
<div class="line">yarp::os::Property propTfClient;</div>
<div class="line">propTfClient.put(<span class="stringliteral">&quot;device&quot;</span>, <span class="stringliteral">&quot;transformClient&quot;</span>);</div>
<div class="line">propTfClient.put(<span class="stringliteral">&quot;local&quot;</span>, <span class="stringliteral">&quot;/transformClientLocal&quot;</span>);</div>
<div class="line">propTfClient.put(<span class="stringliteral">&quot;remote&quot;</span>, <span class="stringliteral">&quot;/transformServer&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check if the driver opened correctly</span></div>
<div class="line"><span class="keywordtype">bool</span> ok_open = m_drvTransformClient.open(propTfClient);</div>
<div class="line"><span class="keywordflow">if</span> (!ok) {</div>
<div class="line">    <span class="comment">// Error...</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check if the view was obtained succesfully</span></div>
<div class="line"><span class="keywordtype">bool</span> ok_view = m_drvTransformClient.view(m_tfClient);</div>
<div class="line"><span class="keywordflow">if</span> (!ok_view || m_tfClient == <span class="keyword">nullptr</span>) {</div>
<div class="line">    <span class="comment">// Error...</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Retrieve the transform</span></div>
<div class="line">yarp::sig::Matrix transform(4, 4);</div>
<div class="line">std::string source = <span class="stringliteral">&quot;/inertial&quot;</span>;</div>
<div class="line">std::string target = <span class="stringliteral">&quot;/&lt;name&gt;/frame&quot;</span>;</div>
<div class="line"><span class="keywordtype">bool</span> ok_transform = m_tfClient-&gt;getTransform(target, source, transform);</div>
<div class="line"><span class="keywordflow">if</span> (!ok_transform) {</div>
<div class="line">    <span class="comment">// Transform not ready...</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>The update rate of the plugin can be configured using the <code>period</code> SDF tag in seconds. If the parameter is not provided a default value of 10 ms is used.</p>
<p>This plugin <b>does not</b> support <a href="http://gazebosim.org/tutorials?tut=nested_model&amp;cat=build_robot">Gazebo nested models</a> since the method <code>gazebo::physics::WorldPose()</code> does not work properly with nested models (see <a href="https://bitbucket.org/osrf/gazebo/issues/2410/wrong-gazebo-physics-model-worldpose-for">issue</a>). </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9b90da86ecc24bde8a06f6ab44b3656b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b90da86ecc24bde8a06f6ab44b3656b">&#9670;&nbsp;</a></span>~GazeboYarpModelPosePublisher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gazebo::GazeboYarpModelPosePublisher::~GazeboYarpModelPosePublisher </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a443d587f78d61eee674eaabe1256f15e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a443d587f78d61eee674eaabe1256f15e">&#9670;&nbsp;</a></span>Load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gazebo::GazeboYarpModelPosePublisher::Load </td>
          <td>(</td>
          <td class="paramtype">gazebo::physics::ModelPtr&#160;</td>
          <td class="paramname"><em>_parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacesdf.html#aa84b558ad591636c16db64bb4c612b71">sdf::ElementPtr</a>&#160;</td>
          <td class="paramname"><em>_sdf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Store pointer to the model, load parameters from the SDF, configure the frame transform client, reset the time of the last update and connect to the World update event of Gazebo. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="ModelPosePublisher_8hh.html">ModelPosePublisher.hh</a></li>
<li><a class="el" href="ModelPosePublisher_8cc.html">ModelPosePublisher.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacegazebo.html">gazebo</a></li><li class="navelem"><a class="el" href="classgazebo_1_1GazeboYarpModelPosePublisher.html">GazeboYarpModelPosePublisher</a></li>
    <li class="footer">Generated on Wed Feb 24 2021 12:33:30 for gazebo-yarp-plugins by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
